<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="Business_Trip" classname="Temp01_SingleDetail" left="0" top="0" width="1030" height="876" titletext="New Form" onload="form_onload" enableevent="true">
    <Layouts>
      <Layout>
        <!-- 검 색 -->
        <!-- 디테일 -->
        <ImageViewer id="img02" taborder="0" left="14" top="97" width="996" height="276" style="background:lavenderblush;border:1 solid #a8a8a8ff ;align:left middle;"/>
        <ImageViewer id="img_titlebg" taborder="3" left="14" top="7" width="996" height="50" style="background:#3366ffff;color:#ffffffff;"/>
        <Static id="sta_title" taborder="4" text="출장관리내역" onclick="sta_title_onclick" left="26" top="18" width="168" height="29" style="color:whitesmoke;align:left middle;font:굴림,12,bold;"/>
        <ImageViewer id="img_02" taborder="6" left="55" top="104" width="950" height="25" style="background:#f0f0f0ff;border:1 solid #a8a8a8ff ;color:black;"/>
        <Static id="sta_17" taborder="7" text="출장일정번호" onclick="sta_17_onclick" left="540" top="104" width="115" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Static id="sta_33" taborder="8" text="출장관리내역" left="17" top="75" width="120" height="13" style="color:#46463dff;align:left top;font:bold 9 굴림;"/>
        <Static id="Static02" taborder="9" text="*" left="39" top="111" width="18" height="22" style="color:red;font:arial,18;"/>
        <Static id="sta_15" taborder="12" text="출장관리번호" onclick="sta_15_onclick" left="20" top="104" width="115" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Static id="Static00" taborder="13" text="*" left="26" top="107" width="18" height="22" style="color:red;font:arial,18;"/>
        <Static id="Static03" taborder="14" text="*" left="547" top="107" width="18" height="22" style="color:red;font:arial,18;"/>
        <ImageViewer id="img_08" taborder="15" left="55" top="221" width="950" height="98" style="background:#f0f0f0ff;border:1 solid #a8a8a8ff ;color:black;"/>
        <ImageViewer id="img_00" taborder="16" left="55" top="128" width="950" height="96" style="background:#f0f0f0ff;border:1 solid #a8a8a8ff ;color:black;"/>
        <Static id="sta_00" taborder="17" text="주요일정내용" onclick="sta_15_onclick" left="20" top="128" width="115" height="97" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <ImageViewer id="img_04" taborder="18" left="55" top="317" width="950" height="25" style="background:#f0f0f0ff;border:1 solid #a8a8a8ff ;color:black;"/>
        <Static id="sta_02" taborder="19" text="비고" onclick="sta_15_onclick" left="20" top="223" width="115" height="97" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Static id="sta_03" taborder="20" text="업무시작일" onclick="sta_15_onclick" left="20" top="317" width="115" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Static id="sta_04" taborder="21" text="업무종료일" onclick="sta_15_onclick" left="277" top="317" width="115" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Calendar id="ws_date" taborder="22" displaynulltext="2021-00-00" left="140" top="319" width="130" height="19" readonly="false"/>
        <Calendar id="wf_date" taborder="23" displaynulltext="2021-00-00" cssclass="essential" left="396" top="319" width="130" height="19"/>
        <Static id="sta_05" taborder="24" onclick="sta_15_onclick" left="532" top="317" width="473" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <ImageViewer id="img_03" taborder="25" left="55" top="341" width="950" height="25" style="background:#f0f0f0ff;border:1 solid #a8a8a8ff ;color:black;"/>
        <Static id="sta_06" taborder="26" text="숙박" onclick="sta_15_onclick" left="20" top="341" width="115" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Static id="sta_07" taborder="27" text="교통" onclick="sta_15_onclick" left="277" top="341" width="115" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Static id="sta_09" taborder="28" text="방문처" onclick="sta_15_onclick" left="532" top="341" width="115" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Static id="sta_10" taborder="29" text="예상경비" onclick="sta_15_onclick" left="769" top="341" width="115" height="25" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;align:center middle;font:굴림,9,bold;"/>
        <Edit id="edt_btrip_dno" taborder="30" readonly="true" cssclass="edt_WF_Search" left="139" top="107" width="391" height="20"/>
        <!--<Edit id="edt_btrip_dno2" taborder="99" readonly="true" cssclass="edt_WF_Search" left="139" top="107" width="391" height="20"/>-->
        <Edit id="edt_btr_dda" taborder="31" readonly="true" cssclass="edt_WF_Search" left="657" top="107" width="340" height="20"/>
        <TextArea id="edt_detail" taborder="33" left="139" top="132" width="863" height="86"/>
        <TextArea id="edt_remark" taborder="34" left="139" top="226" width="863" height="86"/>
        <Edit id="hotel" taborder="35" cssclass="essential" left="139" top="344" width="131" height="19"/>
        <Edit id="trans" taborder="36" cssclass="essential" left="396" top="344" width="131" height="19"/>
        <Edit id="visiter" taborder="37" cssclass="essential" left="649" top="344" width="118" height="19"/>
        <Edit id="tex_expenses" taborder="38" cssclass="essential" left="887" top="344" width="115" height="19"/>
        <Button id="reset" taborder="43" text="취소" onclick="fn_reset" left="951" top="391" width="52" height="23" style="background:URL('img::btn_WFSA_Search_N.png') stretch 9,9 left top;border:1 solid #999999ff ;color:white;bordertype:round 3 3 ;font:bold 9 Dotum;gradation:linear 0,0 #fefefeff 0,100 #ecece5ff;"/>
        <Button id="fn_search" taborder="44" cssclass="btn_WF_SearchSmall" left="981" top="107" width="22" height="20" onclick="fn_search_onclick"/>
        <Button id="Button01" taborder="46" text="추가" left="777" top="391" width="55" height="23" style="pusheddrawoffset:0 0;background:URL('img::btn_WFSA_Search_N.png') stretch 9,9 left top;border:1 solid #999999ff ;color:white;bordertype:round 3 3 ;font:bold 9 Dotum;cursor:hand;gradation:linear 0,0 #fefefeff 0,100 #ecece5ff;" onclick="Button01_onclick"/>
        <Button id="insert00" taborder="47" text="등록" left="835" top="391" width="55" height="23" style="background:URL('img::btn_WFSA_Search_N.png') stretch 9,9 left top;border:1 solid #999999ff ;color:white;bordertype:round 3 3 ;font:bold 9 Dotum;gradation:linear 0,0 #fefefeff 0,100 #ecece5ff;" onclick="div_Detail_insert_onclick"/>
        <Button id="Button02" taborder="48" text="삭제" left="893" top="391" width="55" height="23" style="background:URL('img::btn_WFSA_Search_N.png') stretch 9,9 left top;border:1 solid #999999ff ;color:white;bordertype:round 3 3 ;font:bold 9 Dotum;gradation:linear 0,0 #fefefeff 0,100 #ecece5ff;" onclick="Button02_onclick"/>
        <Grid id="Grid00" taborder="71" scrollbars="autovert" useinputpanel="false" autofittype="col" nodatatext="데이터가 없습니다." left="14" top="446" width="996" height="266" binddataset="ds_user">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="120"/>
                <Column size="150"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="92"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="font:9 Dotum;" text="출장관리번호"/>
                <Cell col="1" style="font:9 Dotum;" text="출장일정번호"/>
                <Cell col="2" style="font:9 Dotum;" text="출장일정내용"/>
                <Cell col="3" style="font:9 Dotum;" text="업무시작일"/>
                <Cell col="4" style="font:9 Dotum;" text="업무종료일" expandchar="bind:ws_Date"/>
                <Cell col="5"/>
              </Band>
              <Band id="body">
                <Cell text="bind:btrip_Dno"/>
                <Cell col="1" text="bind:btrip_Dda"/>
                <Cell col="2" text="bind:detail"/>
                <Cell col="3" text="bind:ws_Date"/>
                <Cell col="4" text="bind:wf_Date"/>
                <Cell col="5"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_user" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="btrip_Dno" type="STRING" size="12"/>
          <!--<Column id="btrip_no" type="STRING" size="12"/>-->
          <Column id="btrip_Dda" type="STRING" size="12"/>
          <Column id="detail" type="STRING" size="255"/>
          <Column id="ws_Date" type="DATE" size="12"/>
          <Column id="wf_Date" type="DATE" size="12"/>
          <Column id="hotel" type="STRING" size="100"/>
          <Column id="trans" type="STRING" size="100"/>
          <Column id="visiter" type="STRING" size="100"/>
          <Column id="tex_Expenses" type="INT" size="10"/>
          <Column id="remark" type="STRING" size="255"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_search">
        <ColumnInfo>
          <Column id="searchCondition" type="STRING" size="256"/>
          <Column id="searchKeyword" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="searchKeyword"/>
            <Col id="searchCondition"/>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item15" compid="edt_btrip_dno" propid="value" datasetid="ds_search" columnid="searchKeyword"/>
      <!--<BindItem id="item16" compid="edt_btrip_dno" propid="value" datasetid="ds_user" columnid="btrip_Dno"/>-->
      <BindItem id="item1" compid="edt_btr_dda" propid="value" datasetid="ds_user" columnid="btrip_Dda"/>
      <BindItem id="item2" compid="edt_detail" propid="value" datasetid="ds_user" columnid="detail"/>
      <BindItem id="item3" compid="edt_remark" propid="value" datasetid="ds_user" columnid="remark"/>
      <BindItem id="item4" compid="ws_date" propid="value" datasetid="ds_user" columnid="ws_Date"/>
      <BindItem id="item5" compid="wf_date" propid="value" datasetid="ds_user" columnid="wf_Date"/>
      <BindItem id="item6" compid="hotel" propid="value" datasetid="ds_user" columnid="hotel"/>
      <BindItem id="item7" compid="trans" propid="value" datasetid="ds_user" columnid="trans"/>
      <BindItem id="item8" compid="visiter" propid="value" datasetid="ds_user" columnid="visiter"/>
      <BindItem id="item9" compid="tex_expenses" propid="value" datasetid="ds_user" columnid="tex_Expenses"/>
      <BindItem id="item14" compid="Grid00" propid="binddataset" datasetid="ds_user"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[include "Lib::Comm.xjs";

this.form_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	//기본 공통  함수 초기화
	Iject.formOnload(obj);
	//this.edt_btrip_dno.set_value(this.parent.ds);
	//this.edt_btr_dno.set_value("11");
   
//     trace(" poup argument1 : "  + Iject.getPopArgu(this,"arg1"));  
//     trace(" poup argument2 : "  + Iject.getPopArgu(this,"arg2"));      
//    var oArgs =  JSON.stringify(Iject.getPopArgu(this,['arg1']));
//    this.edt_btrip_dno.set_value(oArgs);


	
 		var strParam1 = this.parent.param1;
 		this.edt_btrip_dno.set_value(strParam1);
		this.fn_search_onclick();
		
// 		var ds = new Dataset;
// 		ds.set_value(this.edt_btrip_dno.value);
		/*this.edt_searchKeyword.set_value(this.edt_btrip_dno.value);*/
		
		//this.edt_btrip_dno.set_value(strParam2);    
// 	var strReturn = this.edt_btrip_dno.value;
// 	this.close(strReturn);

} 
//조회처리
this.fn_search_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
  
    var searchCondition =  "NAME";
    var searchKeyword = this.edt_btrip_dno.value;       
	this.ds_search.setColumn(0, "searchCondition", "NAME");
	this.ds_search.setColumn(0, "searchKeyword", searchKeyword);
   
   var oDatas =  {
			  svcid : "search",
			  sController : "btrDetailSelectVO.do",			 
			  inds :["ds_search=ds_search"],
			  outds :[
				 "ds_user=output"
			     ],			     
			  args  : [				
			  ],
			  bAsync : true,    // 비동기여부 (true : async  false: sync)
			  nDataType : 0,   // (0: XML타입, 1: 이진 타입, 2: SSV 타입)
			  bCompress :false,	 //			  
			}; 
	 trace(" this.ds_search : " + this.ds_search.saveXML());
	 
	 
    //공통 transaction 함수 호츨   //function callback 
	Iject.transaction(this,oDatas,function(){   
		if(this.errorcode < 0)
		{
		   Iject.alert(this.errorMsg);			
		   return;
		} 
	      
	       var pThis = this.fobj;   //form object	      
	       trace(" ds_user : " + this.ds_user.saveXML());
	});
}
// //사원검색팝업
// 
// this.Button00_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
// {
// 	var nLeft = system.clientToScreenX(this, 10);
// 	var nTop = system.clientToScreenY(this, 10);
// 	 
// 	var empSearch = new ChildFrame;
// 	empSearch.init("emp"
// 					, "absolute", nLeft, nTop, 300, 250, null, null
// 					, "member::empSearch.xfdl");
// 					
// 	empSearch.set_openalign("center middle");
// 	empSearch.set_dragmovetype("all");
// 	
// 	system.showModalWindow(empSearch, 
// 							"empModal",
// 							this.getOwnerFrame(),
// 							"",
// 							this);
// }


//추가
this.Button01_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{
	var imsi = this.edt_btrip_dno.value;
	var nRow = this.ds_user.addRow();
	this.edt_btrip_dno.set_value(imsi);
	
}


 //저장버튼 누를시
 this.div_Detail_insert_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
 {
 	this.fn_save("save");
 }


//저장
this.fn_save = function(strid)
{

//       var searchCondition =  "NAME";
//     var searchKeyword = this.edt_btrip_dno.value;       
// 	this.ds_search.setColumn(0, "searchCondition", "NAME");
	this.ds_user.setColumn(this.ds_user.rowposition, "btrip_Dno", this.edt_btrip_dno.value);
   
	var oDatas =  {
			  svcid : strid,
			  sController : "btrDetailModifyVO.do",			 
			  inds :["input=ds_user:U"],
			  outds :[
				 "ds_user=output"
			     ],			     
			  args  : [				
			  ],
			  bAsync : true,    // 비동기여부 (true : async  false: sync)
			  nDataType : 0,   // (0: XML타입, 1: 이진 타입, 2: SSV 타입)
			  bCompress :false,	 //			  
			}; 
			
    //공통 transaction 함수 호츨   //function callback 
	Iject.transaction(this,oDatas,function(){   
		if(this.errorcode < 0)
		{
		   Iject.alert(this.errorMsg,"알림");			
		   return;
		}			
	      
	       var pThis = this.fobj;   //form object
	       
	       trace(this.svcid);
		    switch(this.svcid)
	      {
	         case "save" : 
				Iject.alert("저장완료");
				break;
				
	         case "dlete" : 
	            Iject.alert("삭제완료");
				break; 
	      }
	      
	    
	});
}



//삭제
this.Button02_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{
 
	var nRow = this.ds_user.rowposition;
	this.ds_user.deleteRow(nRow);
	var rtnValue = Iject.confirm("삭제 하시겠습니까?");
	
// 	
// 	  var searchCondition =  "NAME";
//     var searchKeyword = this.edt_btrip_dno.value;       
// 	this.ds_search.setColumn(0, "searchCondition", "NAME");
// 	this.ds_search.setColumn(0, "searchKeyword", searchKeyword);
//    
  
	
	if(rtnValue){
		this.fn_save("delete");
	}else{
		this.fn_search();
	}
}

 
//리셋
this.fn_reset = function(obj:Button, e:nexacro.ClickEventInfo)
{
	this.ds_user.reset();
}
]]></Script>
  </Form>
</FDL>
