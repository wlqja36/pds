<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="Btrip_management" classname="Btrip_management" left="0" top="0" width="1030" height="876" titletext="New Form" onload="form_onload">
    <Layouts>
      <Layout>
        <Div id="div_Search" taborder="0" left="0.87%" top="67" right="2.14%" height="4.91%" cssclass="div_WF_SearchBg">
          <Layouts>
            <Layout>
              <Static id="st_searchCondition" taborder="19" text="사원이름" cssclass="sta_WF_SearchLabel" left="0.4%" top="24.39%" width="97" height="63.41%" domainId="nexa.s_condition" style="background:#f4edfaff;border:1 solid #c8c8c8ff ;color:#133678ff;font:bold 9 dotum;"/>
              <Edit id="edt_searchKeyword" taborder="18" onkeyup="div_search_btn_search_onclick" left="10.43%" top="24.39%" width="25.58%" height="51.22%" value="hongkildong"/>
              <Button id="Button02" taborder="12" defaultbutton="true" onclick="Button02_onclick" cssclass="btn_WF_SearchSmall" left="39.12%" top="29.27%" width="2.11%" height="51.22%" style="background:URL('img::btn_WFSA_Search_N.png') stretch 9,9 left top;border:1 solid #999999ff ;bordertype:round 3 3 ;"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static01" taborder="1" text="출장관리" cssclass="sta_WF_SubTitle1" left="0.1%" top="13.7%" width="24.27%" height="2.4%"/>
        <Div id="div_Search00" taborder="2" left="-0.49%" top="17.12%" right="2.62%" height="0.23%" style="background:black;border:1 solid black ;" cssclass="div_WF_SearchBg">
          <Layouts>
            <Layout/>
          </Layouts>
        </Div>
        <Div id="div_Detail" taborder="3" left="0.49%" top="11.87%" right="2.43%" height="49.66%" scrollbars="none">
          <Layouts>
            <Layout width="1000" height="418">
              <!-- 출장관리번호 라벨-->
              <Static id="Static02" taborder="0" cssclass="sta_WF_DetailLabel02" left="-0.5%" top="58" right="5" height="6.67%"/>
              <Static id="Static03" taborder="1" text="출장관리번호" cssclass="sta_WF_DetailLabel01" left="-8" top="13.33%" width="10.7%" height="6.67%"/>
              <Edit id="edt_btr_no2" taborder="2" cssclass="edt_WF_Search" left="10.3%" top="14.25%" width="88.7%" height="4.83%" readonly="true" displaynulltext="자료가 없습니다."/>
              <!-- 출장관련 1-->
              <Static id="Static04" taborder="3" cssclass="sta_WF_DetailLabel02" left="-11" top="19.77%" right="5" height="6.67%"/>
              <Static id="Static06" taborder="4" text="출장명" cssclass="sta_WF_DetailLabel01" left="-8" top="19.77%" width="10.7%" height="6.67%"/>
              <Edit id="btr_name" taborder="5" left="10.2%" top="20.69%" width="14.1%" height="4.83%"/>
              <Static id="Static07" taborder="6" text="출장국가" cssclass="sta_WF_DetailLabel01" left="24.6%" top="19.77%" width="10.7%" height="6.67%"/>
              <Edit id="nation" taborder="7" cssclass="essential" left="35.6%" top="20.69%" width="14.1%" height="4.83%"/>
              <Static id="Static18" taborder="8" text="출장지역" cssclass="sta_WF_DetailLabel01" left="50%" top="19.77%" width="10.7%" height="6.67%"/>
              <Edit id="area" taborder="9" cssclass="essential" left="61%" top="20.69%" width="14.1%" height="4.83%"/>
              <MaskEdit id="emp_no" taborder="10" cssclass="essential" text="bind:btrip_No" left="85.6%" top="20.69%" width="12.9%" height="4.83%" readonly="true"/>
              <Static id="Static01" taborder="11" text="사원번호" cssclass="sta_WF_DetailLabel01" left="75.6%" top="19.77%" width="9.9%" height="6.67%"/>
              <Button id="fn_search" taborder="20" onclick="fn_search" cssclass="btn_WF_SearchSmall" left="96.4%" top="14.25%" width="2.1%" height="4.83%"/>
              <!-- 출장목적-->
              <Static id="Static13" taborder="13" cssclass="sta_WF_DetailLabel02" left="-7" top="25.75%" right="0.5%" height="48.97%"/>
              <TextArea id="purpose" taborder="14" left="10.4%" top="26.67%" width="88.3%" height="44.6%"/>
              <Static id="Static16" taborder="15" text="출장목적" cssclass="sta_WF_DetailLabel01" left="-8" top="25.75%" width="10.7%" height="48.97%"/>
              <!--출장날짜-->
              <Static id="Static00" taborder="16" cssclass="sta_WF_DetailLabel02" left="-9" top="74.48%" right="5" height="6.67%"/>
              <MaskEdit id="re_emp_no" taborder="17" cssclass="essential" left="61%" top="75.4%" width="14.1%" height="4.83%"/>
              <Static id="Static36" taborder="18" text="대체업무사원" cssclass="sta_WF_DetailLabel01" left="50.1%" top="74.71%" width="10.6%" height="6.67%"/>
              <Calendar id="f_date" taborder="19" displaynulltext="2021-00-00" cssclass="essential" left="35.8%" top="75.4%" width="14.1%" height="4.83%"/>
              <Static id="Static23" taborder="20" text="출장종료일" cssclass="sta_WF_DetailLabel01" left="24.6%" top="74.48%" width="10.6%" height="6.67%"/>
              <Calendar id="s_date" taborder="21" displaynulltext="2021-00-00" left="10.3%" top="75.86%" width="14.1%" height="4.83%" autoselect="false" autoskip="false" enable="true"/>
              <Static id="Static11" taborder="22" text="출장시작일" cssclass="sta_WF_DetailLabel01" left="-8" top="74.48%" width="10.7%" height="6.67%"/>
              <!--출장승인-->
              <Static id="Static41" taborder="23" cssclass="sta_WF_DetailLabel02" left="-9" top="80.92%" right="0.5%" height="6.67%"/>
              <Static id="Static10" taborder="24" text="승인일시" cssclass="sta_WF_DetailLabel01" left="-8" top="80.92%" width="10.7%" height="6.67%"/>
              <Calendar id="ok_date" taborder="25" displaynulltext="2021-00-00" oneditclick="div_Detail_Calendar02_oneditclick" left="10.4%" top="81.84%" width="14.1%" height="4.83%"/>
              <Static id="Static05" taborder="26" text="승인여부" cssclass="sta_WF_DetailLabel01" left="24.6%" top="80.92%" width="10.6%" height="6.67%"/>
              <MaskEdit id="ex_expenses" taborder="27" left="85.6%" top="75.4%" width="13.3%" height="4.83%"/>
              <Static id="Static29" taborder="28" text="총예상경비" cssclass="sta_WF_DetailLabel01" left="75.3%" top="74.02%" width="10.2%" height="6.67%"/>
              <Static id="Static24" taborder="29" cssclass="sta_WF_DetailLabel01" left="50%" top="80.92%" width="25.1%" height="6.67%"/>
              <Static id="Static37" taborder="30" text="승인자사번" cssclass="sta_WF_DetailLabel01" left="75.3%" top="80.92%" width="10.1%" height="6.67%"/>
              <MaskEdit id="ok_emp_no" taborder="31" cssclass="essential" left="85.6%" top="81.84%" width="13.3%" height="4.83%"/>
              <!--버튼-->
              <Button id="reset" taborder="32" text="취소" onclick="fn_reset" left="91%" top="92.41%" right="2.5%" height="6.9%"/>
              <Button id="delete" taborder="33" text="삭제" left="83.7%" top="92.41%" right="9.8%" height="6.9%" onclick="div_Detail_delete_onclick"/>
              <Button id="insert00" taborder="34" text="등록" onclick="div_Detail_insert_onclick" left="68.5%" top="92.41%" right="25%" height="6.9%"/>
              <Button id="update" taborder="38" text="추가" onclick="div_Detail_update_onclick" left="75.8%" top="92.41%" right="17.7%" height="6.9%"/>
              <Radio id="ok_Ascertain" taborder="36" index="-1" codecolumn="code" datacolumn="data" value="2" direction="vertical" onitemclick="Tab00_tabpage1_div_Detail_ok_Ascertain_onitemclick" left="35.5%" top="81.84%" width="13.4%" height="4.83%" innerdataset="ds_yn">
                <Dataset id="ds_yn">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">Y</Col>
                      <Col id="datacolumn">Y</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">N</Col>
                      <Col id="datacolumn">N</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
            </Layout>
          </Layouts>
        </Div>
        <Grid id="btrgrid" taborder="4" binddataset="ds_user" scrollbars="autovert" useinputpanel="false" autofittype="col" nodatatext="데이터가 없습니다." left="1.36%" top="65.53%" width="96.7%" height="30.37%">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="90"/>
                <Column size="140"/>
                <Column size="200"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="90"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" style="font:bold 9 dotum;" text="출장관리번호" expandsize="12"/>
                <Cell col="2" style="font:bold 9 dotum;" text="출장명"/>
                <Cell col="3" style="font:bold 9 dotum;" text="출장국가"/>
                <Cell col="4" style="font:bold 9 dotum;" text="출장시작일"/>
                <Cell col="5" style="font:bold 9 dotum;" text="출장종료일" combodataset="bind:f_Date"/>
                <Cell col="6" style="font:bold 9 dotum;" text="승인자사번" combodataset="bind:ok_Emp_No"/>
                <Cell col="7" style="font:bold 9 dotum;" text="승인여부" combodataset="bind:ok_Ascertain"/>
              </Band>
              <Band id="body">
                <Cell/>
                <Cell col="1" edittype="none" style="align:center;" text="bind:btrip_No" editlimit="30"/>
                <Cell col="2" edittype="none" style="align:center;" text="bind:btrip_Name" editlimit="15"/>
                <Cell col="3" edittype="none" style="align:center;" text="bind:country" editlimit="15"/>
                <Cell col="4" edittype="none" style="align:center;" text="bind:s_Date" editlimit="15"/>
                <Cell col="5" edittype="none" style="align:center;" text="bind:f_Date" editlimit="11"/>
                <Cell col="6" edittype="none" style="align:center;" text="bind:ok_Emp_No" editlimit="12"/>
                <Cell col="7" edittype="none" style="align:center;" text="bind:ok_Ascertain" editlimit="11"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <ImageViewer id="img_titlebg" taborder="5" onclick="img_titlebg_onclick" left="7" top="6" width="996" height="50" style="background:#3366ffff;color:#ffffffff;"/>
        <Static id="sta_title" taborder="6" text="공통코드마스터관리" onclick="sta_title_onclick" left="26" top="18" width="168" height="29" style="color:whitesmoke;align:left middle;font:굴림,12,bold;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_user" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="btrip_No" type="STRING" size="12"/>
          <Column id="btrip_Name" type="STRING" size="20"/>
          <Column id="country" type="STRING" size="50"/>
          <Column id="area" type="STRING" size="50"/>
          <Column id="purpose" type="STRING" size="256"/>
          <Column id="s_Date" type="DATE" size="256"/>
          <Column id="f_Date" type="DATE" size="256"/>
          <Column id="ex_Expenses" type="INT" size="10"/>
          <Column id="re_Emp_No" type="STRING" size="12"/>
          <Column id="ok_Date" type="DATE" size="256"/>
          <Column id="ok_Emp_No" type="STRING" size="12"/>
          <Column id="ok_Ascertain" type="STRING" size="1"/>
          <Column id="emp_No" type="STRING" size="12"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_search">
        <ColumnInfo>
          <Column id="searchCondition" type="STRING" size="256"/>
          <Column id="searchKeyword" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="searchKeyword"/>
            <Col id="searchCondition"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_yn">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="data" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">Y</Col>
            <Col id="data">Y</Col>
          </Row>
          <Row>
            <Col id="code">N</Col>
            <Col id="data">N</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item15" compid="div_Search.edt_searchKeyword" propid="value" datasetid="ds_search" columnid="searchKeyword"/>
      <BindItem id="item13" compid="div_Search.edt_searchKeyword" propid="value" datasetid="gds_empno" columnid="emp_no"/>
      <BindItem id="item0" compid="div_Detail.edt_btr_no2" propid="value" datasetid="ds_user" columnid="btrip_No"/>
      <BindItem id="item1" compid="div_Detail.btr_name" propid="value" datasetid="ds_user" columnid="btrip_Name"/>
      <BindItem id="item2" compid="div_Detail.nation" propid="value" datasetid="ds_user" columnid="country"/>
      <BindItem id="item3" compid="div_Detail.area" propid="value" datasetid="ds_user" columnid="area"/>
      <BindItem id="item4" compid="div_Detail.purpose" propid="value" datasetid="ds_user" columnid="purpose"/>
      <BindItem id="item5" compid="div_Detail.s_date" propid="value" datasetid="ds_user" columnid="s_Date"/>
      <BindItem id="item6" compid="div_Detail.f_date" propid="value" datasetid="ds_user" columnid="f_Date"/>
      <BindItem id="item17" compid="btrgrid" propid="binddataset" datasetid="ds_user"/>
      <BindItem id="item7" compid="div_Detail.ex_expenses" propid="value" datasetid="ds_user" columnid="ex_Expenses"/>
      <BindItem id="item8" compid="div_Detail.re_emp_no" propid="value" datasetid="ds_user" columnid="re_Emp_No"/>
      <BindItem id="item9" compid="div_Detail.ok_date" propid="value" datasetid="ds_user" columnid="ok_Date"/>
      <BindItem id="item10" compid="div_Detail.ok_emp_no" propid="value" datasetid="ds_user" columnid="ok_Emp_No"/>
      <BindItem id="item11" compid="div_Detail.ok_Ascertain" propid="value" datasetid="ds_user" columnid="ok_Ascertain"/>
      <BindItem id="item12" compid="div_Detail.emp_no" propid="value" datasetid="ds_user" columnid="emp_No"/>
      <!--<BindItem id="item13" compid="div_Detail.emp_no" propid="value" datasetid="gds_empno" columnid="emp_no"/>-->
      <!--<BindItem id="item16" compid="grd_plaintiff11" propid="visible" datasetid="ds_useryn" columnid="id"/>-->
    </Bind>
    <Script type="xscript5.0"><![CDATA[include "Lib::Comm.xjs";


var a= "1";
this.form_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	//기본 공통  함수 초기화
	Iject.formOnload(obj);	
    //this.fn_search();
	
   
} 

//조회
this.fn_search = function(obj:Button,  e:nexacro.ClickEventInfo)
{
  
   var searchCondition =  "NAME";
   var searchKeyword = this.div_Search.edt_searchKeyword.value;       
 	this.ds_search.setColumn(0, "searchCondition", "NAME");
	this.ds_search.setColumn(0, "searchKeyword", searchKeyword);
   
   var oDatas =  {
			  svcid : "search",
			  sController : "btrSelectVO.do",			 
			  inds :["ds_search=ds_search"],
			  outds :[
				 "ds_user=output1"
				 
			     ],			     
			  args  : [				
			  ],
			  bAsync : true,    // 비동기여부 (true : async  false: sync)
			  nDataType : 0,   // (0: XML타입, 1: 이진 타입, 2: SSV 타입)
			  bCompress :false,	 //			  
			}; 
			
	 trace(" this.ds_search : " + this.ds_search.saveXML());
	  
    //공통 transaction 함수 호츨   //function callback 
	Iject.transaction(this,oDatas,function(){   
		
		if(this.errorcode < 0)
		{
		   Iject.alert(this.errorMsg);			
		   return;
		} 
	      
	       var pThis = this.fobj;   //form object	      
	       trace(" ds_user : " + pThis.ds_user.saveXML());
	});
		var imsi = this.div_Search.edt_searchKeyword.value;
		
			
	
	
	this.div_Detail.edt_btrip_dno.set_value(imsi);
	
	
	
	if(this.div_Detail.edt_btr_no2.text == null){
		this.div_Detail.emp_no.set_value(imsi);
	}
	
	 
}


//추가
this.div_Detail_update_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	
	this.div_Detail.emp_no.set_readonly("false");
	var nRow = this.ds_user.addRow();
	this.div_search.edt_searchKeyword.set_value("");
}

//삭제
this.div_Detail_delete_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nRow = this.ds_user.rowposition;
	this.ds_user.deleteRow(nRow);
	var rtnValue = Iject.confirm("삭제 하시겠습니까?");
	
	if(rtnValue)
	{
		this.fn_save("delete");
	}
	else
	{
		this.fn_search();
	}
}

//리셋
this.fn_reset = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.ds_user.reset();
}


//저장
this.fn_save = function(strid)
{
     
	var oDatas =  {
			  svcid : strid,
			  sController : "btrModifyVO.do",			 
			  inds :["input1=ds_user:U"],
			  outds :[
				 "ds_user=output1"
			     ],			     
			  args  : [				
			  ],
			  bAsync : true,    // 비동기여부 (true : async  false: sync)
			  nDataType : 0,   // (0: XML타입, 1: 이진 타입, 2: SSV 타입)
			  bCompress :false,	 //			  
			}; 
			
    //공통 transaction 함수 호츨   //function callback 
	Iject.transaction(this,oDatas,function(){   
		
		if(this.errorcode < 0)
		{
		   Iject.alert(this.errorMsg,"알림");			
		   return;
		}			
	      
	       var pThis = this.fobj;   //form object
	      
	      pThis.div_search.edt_searchKeyword.set_value(pThis.edt_fullName.value);
		  pThis.fn_search();
	});
}


//저장버튼 클릭시 
this.div_Detail_insert_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_save("save");
}

//검색  Enter키
this.div_search_btn_search_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if ( e.keycode == 13 )
	{
		this.fn_search();
	}
}



//사원이름검색팝업창

this.Button02_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{
		var nLeft = system.clientToScreenX(this, 10);
	var nTop = system.clientToScreenY(this, 10);
	 
	var empSearch = new ChildFrame;
	empSearch.init("emp"
					, "absolute", nLeft, nTop, 300, 250, null, null
					, "member::empSearch.xfdl");
					
	empSearch.set_openalign("center middle");
	empSearch.set_dragmovetype("all");
	
	system.showModalWindow(empSearch, 
							"empModal",
							this.getOwnerFrame(),
							"",
							this);
}
]]></Script>
  </Form>
</FDL>
