<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="LJH_EMP_EVAL" classname="LJH_EMP_EVAL" inheritanceid="" position="absolute" left="0" top="0" width="800" height="350" titletext="인사평가" style="align:left middle;" onload="form_onload" tooltiptype="default">
    <Layouts>
      <Layout>
        <ImageViewer id="ImageViewer00" taborder="0" left="0" top="0" height="45" style="background:#165fa6ff;border:1 solid #0080c0ff ;" width="800"/>
        <ImageViewer id="ImageViewer01" taborder="1" left="29" top="58" height="214" style="background:#d8dcedff;border:1 solid #969696ff ;" onclick="ImageViewer01_onclick" width="732"/>
        <Static id="sta_eval_01" taborder="2" left="34" top="63" height="40" style="background:#f0f0f0ff;border:1 solid #969696ff ;" width="722"/>
        <Static id="Static02" taborder="3" left="34" top="186" height="40" style="background:#f0f0f0ff;border:1 solid #969696ff ;" width="722"/>
        <Static id="Static03" taborder="4" left="34" top="145" height="40" style="background:#f0f0f0ff;border:1 solid #969696ff ;" width="722"/>
        <Static id="Static04" taborder="5" left="34" top="104" height="40" style="background:#f0f0f0ff;border:1 solid #969696ff ;" width="722"/>
        <Static id="Static05" taborder="6" left="34" top="227" height="40" style="background:#f0f0f0ff;border:1 solid #969696ff ;" width="722"/>
        <Static id="sta_eval_06" taborder="7" text="사용여부" left="34" top="63" height="40" style="background:#f4edfaff;border:1 solid #969696ff ;color:#000080ff;align:center;font:bold 9 Dotum;" width="120"/>
        <Static id="sta_eval_07" taborder="8" text="인사평가대장번호" left="34" top="104" height="40" style="background:#f4edfaff;border:1 solid #969696ff ;color:#000080ff;align:center;font:bold 9 Dotum;" width="120"/>
        <Static id="sta_eval_08" taborder="9" text="부서평가코드" left="34" top="145" height="40" style="background:#f4edfaff;border:1 solid #969696ff ;color:#000080ff;align:center;font:bold 9 Dotum;" width="120"/>
        <Static id="sta_eval_09" taborder="10" text="인사평가코드" left="34" top="186" height="40" style="background:#f4edfaff;border:1 solid #969696ff ;color:#000080ff;align:center;font:bold 9 Dotum;" width="120"/>
        <Static id="sta_eval_10" taborder="11" text="총점" left="34" top="227" height="40" style="background:#f4edfaff;border:1 solid #969696ff ;color:#000080ff;align:center;font:bold 9 Dotum;" width="120"/>
        <Static id="sta_eval_11" taborder="12" text="사원번호" left="360" top="104" height="40" style="background:#f4edfaff;border:1 solid #969696ff ;color:#000080ff;align:center;font:bold 9 Dotum;" width="121"/>
        <Static id="sta_eval_12" taborder="13" text="부서장평가점수합계" left="360" top="145" height="40" style="background:#f4edfaff;border:1 solid #969696ff ;color:#000080ff;align:center;font:bold 9 Dotum;" width="121"/>
        <Static id="sta_eval_13" taborder="14" text="인사평가점수합계" left="360" top="186" height="40" style="background:#f4edfaff;border:1 solid #969696ff ;color:#000080ff;align:center;font:bold 9 Dotum;" width="121"/>
        <Static id="static_emp_eval_no" taborder="15" text="01" left="162" top="110" height="30" width="138"/>
        <Static id="sta_emp_no" taborder="16" text="02" left="489" top="111" height="30" width="193" onclick="sta_emp_no_onclick"/>
        <Combo id="ds_eval_head_code" taborder="17" left="160" top="150" height="30" width="184" displaynulltext="선택" innerdataset="@ds_eval_head_code00" codecolumn="code" datacolumn="name"/>
        <Combo id="ds_eval_code" taborder="18" left="160" top="191" height="30" width="184" index="-1" displaynulltext="선택" innerdataset="@ds_eval_code00" codecolumn="code" datacolumn="name"/>
        <Edit id="EMP_EVAL2" taborder="19" left="486" top="150" height="30" width="257" ontextchanged="EMP_EVAL2_ontextchanged" oneditclick="EMP_EVAL2_oneditclick" maxlength="30"/>
        <Edit id="EMP_EVAL1" taborder="20" left="486" top="191" height="30" width="257" ontextchanged="EMP_EVAL1_ontextchanged" oneditclick="EMP_EVAL1_oneditclick" maxlength="30"/>
        <Static id="static_emp_eval_sum" taborder="25" left="160" top="233" height="30" width="318"/>
        <Button id="btn_save" taborder="21" text="저장" left="600" top="296" height="24" width="61" style="background:URL('img::btn_imgs.png') stretch 0,0;color:#ffffffff;font:bold 9 Dotum;gradation:linear 0,0 #fefefeff 0,100 #ecece5ff;" onclick="btn_save_onclick"/>
        <Button id="btn_del" taborder="22" text="삭제" left="672" top="296" height="24" width="61" style="background:URL('img::btn_imgs.png') stretch 0,0;color:#ffffffff;font:bold 9 Dotum;" onclick="Button00_onclick"/>
        <Radio id="Radio00" taborder="23" left="20.25%" top="66" right="68.13%" height="30" codecolumn="codecolumn" datacolumn="datacolumn" index="-1" direction="vertical" onitemchanged="Radio00_onitemchanged">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Static id="sta_eval_title" taborder="24" text="인사평가" position="absolute" onclick="sta_eval_title_onclick" left="10" top="2" width="352" height="40" style="color:#ffffffff;font:bold 16 Arial Black;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_emp_eval_book">
        <ColumnInfo>
          <Column id="EMP_EVAL_BOOK_NO" type="STRING" size="12"/>
          <Column id="EMP_EVAL_BOOK_NM" type="STRING" size="256"/>
          <Column id="EVAL_TERM_CLASS_CODE" type="STRING" size="4"/>
          <Column id="EVAL_TERM_CODE" type="STRING" size="4"/>
          <Column id="EMP_EVAL_STA_DATE" type="DATE" size="256"/>
          <Column id="EMP_EVAL_END_DATE" type="DATE" size="256"/>
          <Column id="EMP_REG_DATE" type="DATE" size="256"/>
          <Column id="EMP_EVAL_REG_USER_NO" type="STRING" size="12"/>
          <Column id="EMP_EVAL_MOD_DATE" type="DATE" size="256"/>
          <Column id="EMP_EVAL_MOD_USER_NO" type="STRING" size="12"/>
          <Column id="EMP_EVAL_ACC_DATE" type="DATE" size="256"/>
          <Column id="EMP_EVAL_ACC_USER_NO" type="STRING" size="12"/>
          <Column id="EMP_EVAL_ACC_YN" type="STRING" size="1"/>
          <Column id="EMP_EVAL_SUM" type="INT" size="3"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_eval_date_code">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="name" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">4010</Col>
            <Col id="name">년간</Col>
          </Row>
          <Row>
            <Col id="code">4020</Col>
            <Col id="name">반</Col>
          </Row>
          <Row>
            <Col id="name">분기</Col>
            <Col id="code">4030</Col>
          </Row>
          <Row>
            <Col id="name">월간</Col>
            <Col id="code">4040</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_eval_code00" enableevent="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="name" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">4210</Col>
            <Col id="name">4210/출결평가</Col>
          </Row>
          <Row>
            <Col id="code">4220</Col>
            <Col id="name">4220/근태평가</Col>
          </Row>
          <Row>
            <Col id="code">4230</Col>
            <Col id="name">4230/능력평가</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_emp_eval_head">
        <ColumnInfo>
          <Column id="EMP_NO" type="STRING" size="256"/>
          <Column id="emp_eval_book_no" type="STRING" size="256"/>
          <Column id="eval_head_code" type="STRING" size="256"/>
          <Column id="eval_head_score" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_emp_no">
        <ColumnInfo>
          <Column id="emp_no" type="STRING" size="256"/>
          <Column id="emp_eval_book_no" type="STRING" size="256"/>
          <Column id="emp_eval_yn" type="STRING" size="256"/>
          <Column id="eval_std_score_sum" type="INT" size="256"/>
          <Column id="eval_head_score_sum" type="INT" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_emp_full">
        <ColumnInfo>
          <Column id="EMP_NO" type="STRING" size="256"/>
          <Column id="EMP_EVAL_BOOK_NO" type="STRING" size="256"/>
          <Column id="EVAL_STD_CODE" type="STRING" size="256"/>
          <Column id="EVAL_HEAD_CODE" type="STRING" size="256"/>
          <Column id="EVAL_HEAD_SCORE_SUM" type="INT" size="256"/>
          <Column id="EVAL_STD_SCORE_SUM" type="INT" size="256"/>
          <Column id="EMP_EVAL_SUM" type="INT" size="256"/>
          <Column id="EMP_EVAL_YN" type="STRING" size="2"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search">
        <ColumnInfo>
          <ConstColumn id="PageIndex" type="INT" size="30" value="1"/>
          <ConstColumn id="PageSize" type="INT" size="30" value="5"/>
          <ConstColumn id="PageUnit" type="INT" size="30" value="5"/>
          <Column id="searchCondition" type="STRING" size="100"/>
          <Column id="searchKeyword" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_masterCodeList">
        <ColumnInfo>
          <Column id="rownum" type="STRING" size="256"/>
          <Column id="classCode" type="STRING" size="256"/>
          <Column id="className" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="mainTable" type="STRING" size="256"/>
          <Column id="mainColumn" type="STRING" size="256"/>
          <Column id="classDesc" type="STRING" size="256"/>
          <Column id="registTime" type="STRING" size="256"/>
          <Column id="registId" type="STRING" size="256"/>
          <Column id="modifyTime" type="STRING" size="256"/>
          <Column id="modifyId" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_detailCodeList">
        <ColumnInfo>
          <Column id="rownum" type="INT" size="256"/>
          <Column id="classCode" type="STRING" size="256"/>
          <Column id="className" type="STRING" size="256"/>
          <Column id="codeNo" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="codeName2" type="STRING" size="256"/>
          <Column id="codeEngName" type="STRING" size="256"/>
          <Column id="etcCode1" type="STRING" size="256"/>
          <Column id="etcCode2" type="STRING" size="256"/>
          <Column id="codeDesc" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="sort" type="STRING" size="256"/>
          <Column id="registTime" type="STRING" size="256"/>
          <Column id="registId" type="STRING" size="256"/>
          <Column id="modifyTime" type="STRING" size="256"/>
          <Column id="modifyId" type="STRING" size="256"/>
          <Column id="lastModyDate" type="STRING" size="256"/>
          <Column id="higherClassCode" type="STRING" size="256"/>
          <Column id="higherCodeNo" type="STRING" size="256"/>
          <Column id="rnum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_eval_head_code00">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="name" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">4110</Col>
            <Col id="name">4110/책임감</Col>
          </Row>
          <Row>
            <Col id="code">4120</Col>
            <Col id="name">4120/적극</Col>
          </Row>
          <Row>
            <Col id="code">4130</Col>
            <Col id="name">4130/수행능력</Col>
          </Row>
          <Row>
            <Col id="code">4140</Col>
            <Col id="name">4140/규정준수</Col>
          </Row>
          <Row>
            <Col id="code">4150</Col>
            <Col id="name">4150/영업실적</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item8" compid="LJH_EMP_EVAL_BOOK" propid="font" datasetid="ds_search" columnid=""/>
      <BindItem id="item0" compid="Radio00" propid="value" datasetid="ds_emp_full" columnid="EMP_EVAL_YN"/>
      <BindItem id="item1" compid="static_emp_eval_no" propid="text" datasetid="ds_emp_full" columnid="EMP_EVAL_BOOK_NO"/>
      <BindItem id="item2" compid="ds_eval_head_code" propid="value" datasetid="ds_emp_full" columnid="EVAL_HEAD_CODE"/>
      <BindItem id="item3" compid="ds_eval_code" propid="value" datasetid="ds_emp_full" columnid="EVAL_STD_CODE"/>
      <BindItem id="item4" compid="static_emp_eval_sum" propid="text" datasetid="ds_emp_full" columnid="EMP_EVAL_SUM"/>
      <BindItem id="item5" compid="EMP_EVAL2" propid="value" datasetid="ds_emp_full" columnid="EVAL_HEAD_SCORE_SUM"/>
      <BindItem id="item6" compid="EMP_EVAL1" propid="value" datasetid="ds_emp_full" columnid="EVAL_STD_SCORE_SUM"/>
      <BindItem id="item7" compid="Radio00" propid="" datasetid="ds_emp_full" columnid=""/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[include "Lib::Comm.xjs";

this.form_onload = function(obj:Form, e:nexacro.LoadEventInfo){
    //데이터는 하나 뿐이니까 전부 0행으로 잡을것
    var strParam1 = this.parent.param1; //대장번호
    var strParam2 = this.parent.param2; //사원번호
    var strParam3 = this.parent.param3; //사원번호(보여주기용)
    
    this.sta_emp_no.set_text(strParam3);
    //검색어 설정 (sta_emp_no에 바인딩 안하고 여기서 작성함)
    var nRow = this.ds_search.addRow();
	this.ds_search.setColumn(nRow,"searchKeyword", strParam1);
	
	var oDatas =  {
			 svcid : "select",
			 sController : "ljhselectEmpEval_PopupVO.do",	
			 bAsync : true,
			 inds : [ "ds_search=ds_search"],
			 outds : [
						"ds_emp_full=ds_emp_full"
						],
			 nDataType : 0,   
			 bCompress :false,	 		  
	};
	//실행시
	Iject.transaction(this,oDatas,function(){
		if(this.errorcode < 0)
		{
		   Iject.alert(this.errorMsg);			
		   return;
		} 
	    var pThis = this.fobj;        
	    
	    trace(" ds_emp_full당 : " + pThis.ds_emp_full.saveXML());
	    var sum = nexacro.toNumber(nexacro.toNumber(pThis.EMP_EVAL1.value) + nexacro.toNumber(pThis.EMP_EVAL2.value));
	    pThis.ds_emp_full.setColumn(0,"EMP_EVAL_SUM", sum);
		if(pThis.ds_emp_full.getColumn(nRow_full,"EMP_EVAL_BOOK_NO") != undefined){
			if(pThis.ds_emp_full.getColumn(nRow_full,"EMP_EVAL_YN") == 'N'){
				pThis.EMP_EVAL2.set_enable("false");
				pThis.EMP_EVAL1.set_enable("false");
				pThis.ds_eval_head_code.set_enable("false");
				pThis.ds_eval_code.set_enable("false");
			}

		}else{
			var nRow_full = pThis.ds_emp_full.addRow();

			pThis.ds_emp_full.setColumn(nRow_full,"EMP_EVA0L_YN", 'N');
			pThis.ds_emp_full.setColumn(nRow_full,"EMP_EVAL_BOOK_NO", strParam1);
			pThis.static_emp_eval_sum.set_text(0);
			pThis.ds_emp_full.setColumn(nRow_full,"EMP_EVAL_SUM", pThis.static_emp_eval_sum.text);
			pThis.ds_emp_full.setColumn(nRow_full,"EMP_NO", strParam3);
			
			
			
			pThis.EMP_EVAL2.set_enable("false");
			pThis.EMP_EVAL1.set_enable("false");
			pThis.ds_eval_head_code.set_enable("false");
			pThis.ds_eval_code.set_enable("false");
		}
		
	});
	
}

//저장
this.fn_save = function(strid)
{

	var oDatas =  {
			  svcid : strid,
			  sController : "ljhempEvalPopUpModifyVO.do",			 
			  inds :["ds_input=ds_emp_full:U"],
			  outds :[
				 "ds_emp_full=output1"
			     ],			     
			  args  : [				
			  ],
			  bAsync : true,   
			  nDataType : 0,   
			  bCompress :false,	 		  
			}; 
			
	//실행부
	Iject.transaction(this,oDatas,function(){   
 
		if(this.errorcode < 0)
		{
		   Iject.alert(this.errorMsg,"알림");			
		   return;
		}			
	      
	    var pThis = this.fobj;   //form object
	       
	      switch(oDatas.svcid)
	      {
			 case "insert" :
				Iject.alert("삽입완료");
				break;
	         case "save" : 
				Iject.alert("저장완료");
				break;
				
	         case "delete" : 
	            Iject.alert("삭제완료");
				break; 
	      }
	});
	
}






this.btn_save_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{
	this.fn_save("save");
}

this.btn_delete_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{

	var nRow = this.ds_emp_full.rowposition;
	this.ds_emp_full.deleteRow(nRow);
	var rtnValue = Iject.confirm("삭제 하시겠습니까?");
	
	if(rtnValue)
	{
		this.fn_save("delete");
	}
}



this.EMP_EVAL1_ontextchanged = function(obj:Edit, e:nexacro.TextChangedEventInfo)
{
	
	var sum = nexacro.toNumber(nexacro.toNumber(this.EMP_EVAL1.value) + nexacro.toNumber(this.EMP_EVAL2.value));
	this.ds_emp_full.setColumn(0,"EMP_EVAL_SUM", sum);
}

this.EMP_EVAL2_ontextchanged = function(obj:Edit, e:nexacro.TextChangedEventInfo)
{
	var sum = nexacro.toNumber(nexacro.toNumber(this.EMP_EVAL1.value) + nexacro.toNumber(this.EMP_EVAL2.value));
	this.ds_emp_full.setColumn(0,"EMP_EVAL_SUM", sum);
}



this.Radio00_onitemchanged = function(obj:Radio, e:nexacro.ItemChangeEventInfo)
{
	if(this.Radio00.value == 'Y'){
		this.EMP_EVAL2.set_enable("true");
		this.EMP_EVAL1.set_enable("true");
		this.ds_eval_head_code.set_enable("true");
		this.ds_eval_code.set_enable("true");
	}else if(this.Radio00.value == 'N'){
		this.EMP_EVAL2.set_enable("false");
		this.EMP_EVAL1.set_enable("false");
		this.ds_eval_head_code.set_enable("false");
		this.ds_eval_code.set_enable("false");
	}
}





this.Button00_onclick = function(obj:Button, e:nexacro.ClickEventInfo)
{
	var nRow = this.ds_emp_full.rowposition;
	this.ds_emp_full.deleteRow(nRow);
	var rtnValue = Iject.confirm("삭제 하시겠습니까?");
	
	if(rtnValue)
	{
		this.fn_save("delete");
	}
	else
	{
		//this.fn_search();
	}
}]]></Script>
  </Form>
</FDL>
