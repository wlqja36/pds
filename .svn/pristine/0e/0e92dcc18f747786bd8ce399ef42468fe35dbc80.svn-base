<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="s_book">

	<typeAlias alias="searchVO" type="nexacro.sample.vo.DefaultVO" />
	<typeAlias alias="sbVO" type="nexacro.sample.vo.s_bookVO.S_bookVO" />
	

	<!-- Sample resultObject -->
	<resultMap id="sb" class="sbVO">
		<result property="salary_book_no" column="SALARY_BOOK_NO" />
		<result property="salary_book_code" column="SALARY_BOOK_CODE" />
		<result property="salary_book_nm" column="SALARY_BOOK_NM" />
		<result property="salary_book_reg_date" column="SALARY_BOOK_REG_DATE" />
		<result property="salary_send_date" column="SALARY_SEND_DATE" />
		<result property="salary_reg_user_no" column="SALARY_REG_USER_NO" />
		<result property="salary_mod_date" column="SALARY_MOD_DATE" />
		<result property="salary_mod_user_no" column="SALARY_MOD_USER_NO" />
		<result property="salary_acc_date" column="SALARY_ACC_DATE" />
		<result property="salary_acc_user_no" column="SALARY_ACC_USER_NO" />
		<result property="salary_acc_yn" column="SALARY_ACC_YN" />
		<result property="salary_cal_sta_date" column="SALARY_CAL_STA_DATE" />
		<result property="salary_cal_end_date" column="SALARY_CAL_END_DATE" />
		<result property="salary_total" column="SALARY_TOTAL" />
		<result property="attitude_book_id" column="ATTITUDE_BOOK_ID" />
	</resultMap>


	
	<select id="s_book.selectbtrVOList" parameterClass="sbVO"
		resultMap="sb">
		<![CDATA[
		SELECT
			SALARY_BOOK_NO,
			SALARY_BOOK_CODE,
			SALARY_BOOK_NM,
			SALARY_BOOK_REG_DATE,
			SALARY_SEND_DATE,
			SALARY_REG_USER_NO,
			SALARY_MOD_DATE,
			SALARY_MOD_USER_NO,
			SALARY_ACC_DATE,
			SALARY_ACC_USER_NO,
			SALARY_ACC_YN,
			SALARY_CAL_STA_DATE,
			SALARY_CAL_END_DATE,
			SALARY_TOTAL,
			ATTITUDE_BOOK_ID
		FROM 
		(SELECT SALARY_BOOK_NO, 
		SALARY_BOOK_CODE,
		SALARY_BOOK_NM,
		SALARY_BOOK_REG_DATE,
		SALARY_SEND_DATE,
		(SELECT EMP_NAME FROM EMP WHERE SALARY_REG_USER_NO = EMP_NO)||' '||SALARY_REG_USER_NO SALARY_REG_USER_NO,
		SALARY_MOD_DATE,
		(SELECT EMP_NAME FROM EMP WHERE SALARY_MOD_USER_NO = EMP_NO)||' '||SALARY_MOD_USER_NO SALARY_MOD_USER_NO,
		SALARY_ACC_DATE,
		(SELECT EMP_NAME FROM EMP WHERE SALARY_ACC_USER_NO = EMP_NO)||' '||SALARY_ACC_USER_NO SALARY_ACC_USER_NO,
		SALARY_ACC_YN,
		SALARY_CAL_STA_DATE,
		SALARY_CAL_END_DATE,
		SALARY_TOTAL,
		ATTITUDE_BOOK_ID
		FROM SALARY_BOOK ORDER BY SALARY_BOOK_NM) 
	
		
		]]>
		<!-- null로바꿔보기 -->
		<isNotEqual property="searchKeyword" compareValue="all">	
		</isNotEqual>
		<isNotEqual property="searchKeyword" compareValue="SALARY_BOOK_NM">
			WHERE SALARY_BOOK_NM LIKE '%'||#searchKeyword#||'%'
		</isNotEqual>


	</select>


	<insert id="s_book.insertbtrVOList" parameterClass="sbVO">
        <![CDATA[
            INSERT INTO SALARY_BOOK (
                SALARY_BOOK_NO,	
				SALARY_BOOK_CODE,	
				SALARY_BOOK_NM,
				SALARY_BOOK_REG_DATE,	
				SALARY_SEND_DATE,	
				SALARY_REG_USER_NO,	
				SALARY_MOD_DATE,	
				SALARY_MOD_USER_NO,	
				SALARY_ACC_DATE,	
				SALARY_ACC_USER_NO,	
				SALARY_ACC_YN,	
				SALARY_CAL_STA_DATE,	
				SALARY_CAL_END_DATE,
				SALARY_TOTAL,
				ATTITUDE_BOOK_ID) 
			VALUES (
                #salary_book_no#,
				#salary_book_code#,
				#salary_book_nm#,
				#salary_book_reg_date#,
				#salary_send_date#,
				#salary_reg_user_no#,
				#salary_mod_date:VARCHAR#,
				#salary_mod_user_no:VARCHAR#,
				#salary_acc_date#,
				#salary_acc_user_no#,
				#salary_acc_yn#,
				#salary_cal_sta_date:VARCHAR#,
				#salary_cal_end_date:VARCHAR#,
				#salary_total#,
				#attitude_book_id:VARCHAR#)
        ]]>
	</insert>

	<update id="s_book.updatebtrVOList" parameterClass="sbVO">
        <![CDATA[
            UPDATE SALARY_BOOK 
            SET 
				SALARY_BOOK_CODE =#salary_book_code#,
				SALARY_TOTAL = #salary_total#	
				        
            WHERE SALARY_BOOK_NO=#salary_book_no#
        ]]>
	</update>

	<delete id="s_book.deletebtrVOList" parameterClass="sbVO">
        <![CDATA[
            DELETE FROM SALARY_BOOK
            WHERE SALARY_BOOK_NO=#salary_book_no#
        ]]>
	</delete>


	 
</sqlMap>
